<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BhenzFlix Music</title>

<style>
body{
    margin:0;
    font-family:Arial, sans-serif;
    color:white;
    text-align:center;
    background:black;
    overflow:hidden;
}

/* SMOKE BACKGROUND */
#bg{
    position:fixed;
    width:100%;
    height:100%;
    background:radial-gradient(circle at center, #330000, #000);
    animation:smoke 8s infinite alternate;
    z-index:-2;
}

@keyframes smoke{
    0%{filter:blur(20px);}
    100%{filter:blur(60px);}
}

/* LIGHTNING FLASH */
.flash{
    position:fixed;
    width:100%;
    height:100%;
    background:white;
    opacity:0;
    pointer-events:none;
    z-index:-1;
}

/* TOP BAR */
.topbar{
    padding:20px;
    font-size:22px;
    font-weight:bold;
    letter-spacing:5px;
    color:red;
    text-shadow:0 0 15px red;
}

/* ALBUM */
.album{
    width:200px;
    height:200px;
    border-radius:50%;
    margin:20px auto;
    background:url('https://i.imgur.com/3ZQ3Z9S.png') center/cover no-repeat;
    box-shadow:0 0 40px red;
}

/* CONTROLS */
.btn{
    background:none;
    border:none;
    color:white;
    font-size:30px;
    margin:10px;
}

/* PLAYLIST */
.song{
    padding:10px;
    border-bottom:1px solid #222;
    cursor:pointer;
}
.song:hover{background:#111;}
.active{color:red;}

/* CANVAS VISUALIZER */
canvas{
    width:100%;
    height:120px;
}
</style>
</head>

<body>

<div id="bg"></div>
<div class="flash" id="flash"></div>

<div class="topbar">üéµ BHENZFLIX MUSIC</div>

<div class="album"></div>

<h3 id="title">Now Playing</h3>

<button class="btn" onclick="prevSong()">‚èÆ</button>
<button class="btn" onclick="togglePlay()">‚ñ∂</button>
<button class="btn" onclick="nextSong()">‚è≠</button>

<canvas id="visualizer"></canvas>

<div id="playlist"></div>

<audio id="player" crossorigin="anonymous"></audio>

<script>
var songs=[
{
title:"All That I've Got - The Used",
file:"https://www.dropbox.com/scl/fi/wdu2alcuhrsm8awna1uj1/All-That-I-ve-Got-The-Used-320K.mp3?raw=1"
},
{
title:"Bad Day - Daniel Powter",
file:"https://www.dropbox.com/scl/fi/13zp82q80ap63jdiv6xuf/Bad-Day-Daniel-Powter-320K.mp3?raw=1"
}
];

var currentIndex=0;
var player=document.getElementById("player");
var title=document.getElementById("title");
var playlist=document.getElementById("playlist");
var flash=document.getElementById("flash");

/* PLAYLIST LOAD */
songs.forEach((song,index)=>{
let div=document.createElement("div");
div.className="song";
div.innerText=song.title;
div.onclick=function(){
currentIndex=index;
playSong();
};
playlist.appendChild(div);
});

function playSong(){
player.src=songs[currentIndex].file;
title.innerText=songs[currentIndex].title;
player.play();
updateActive();
}

function togglePlay(){
if(player.paused){player.play();}
else{player.pause();}
}

function nextSong(){
currentIndex++;
if(currentIndex>=songs.length){currentIndex=0;}
playSong();
}

function prevSong(){
currentIndex--;
if(currentIndex<0){currentIndex=songs.length-1;}
playSong();
}

function updateActive(){
document.querySelectorAll(".song").forEach(s=>s.classList.remove("active"));
document.querySelectorAll(".song")[currentIndex].classList.add("active");
}

player.onended=function(){nextSong();}

/* REAL VISUALIZER */
const canvas=document.getElementById("visualizer");
const ctx=canvas.getContext("2d");
canvas.width=window.innerWidth;
canvas.height=120;

const audioCtx=new (window.AudioContext||window.webkitAudioContext)();
const analyser=audioCtx.createAnalyser();
const source=audioCtx.createMediaElementSource(player);
source.connect(analyser);
analyser.connect(audioCtx.destination);
analyser.fftSize=256;

const bufferLength=analyser.frequencyBinCount;
const dataArray=new Uint8Array(bufferLength);

function animate(){
requestAnimationFrame(animate);
analyser.getByteFrequencyData(dataArray);

ctx.fillStyle="black";
ctx.fillRect(0,0,canvas.width,canvas.height);

let barWidth=(canvas.width/bufferLength)*2.5;
let barHeight;
let x=0;

for(let i=0;i<bufferLength;i++){
barHeight=dataArray[i];
ctx.fillStyle="red";
ctx.fillRect(x,canvas.height-barHeight/2,barWidth,barHeight/2);
x+=barWidth+1;
}

/* Lightning flash effect */
if(Math.max(...dataArray)>230){
flash.style.opacity=0.4;
setTimeout(()=>flash.style.opacity=0,100);
}
}
animate();
</script>

</body>
</html>
